<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Tuesday, December 09, 2008, 2:04 PM -->
<!-- MuClient version 4.37 -->

<!-- Plugin "tts_NVDA" generated by Plugin Wizard -->

<muclient>
<plugin
   name="MushReader"
   author="Tyler Spivey"
   id="925cdd0331023d9f0b8f05a7"
   language="Lua"
   purpose="Plugin for multiple screen readers"
   save_state="y"
   date_written="2009-11-06 17:00:34"
   requires="4.60"
   version="1.1"
   >

</plugin>
<aliases>
  <alias
   match="tts_stop"
   enabled="y"
   send_to="12"
   sequence="100"
  >
<send>stop()</send>
  </alias>
  <alias
   match="tts_interrupt *"
   enabled="y"
   send_to="12"
   sequence="100"
  >
  <send>
if jfwobject and nvda.jaws_running() then
jfwobject:SayString("%1", 1)
else
stop()
say("%1")
end
</send>
  </alias>
<alias
   match="tts_note *"
   enabled="y"
   send_to="12"
   sequence="100"
  >
  <send>say("%1")</send>
  </alias>

  <alias
   script="TTSToggle"
   match="tts"
   enabled="y"
   group="TTS"
   omit_from_command_history="y"
   omit_from_log="y"
   omit_from_output="y"
   sequence="100"
  >
  </alias>
</aliases>


<!--  Get our standard constants -->

<include name="constants.lua"/>
<script>
<![CDATA[
tts_enabled = true
function OnPluginInstall ()
assert(package.loadlib("MushReader.dll", "luaopen_audio"))()
stop()
say("mush reader initialized")
end
function say(str)
nvda.say(str)
end
function stop()
nvda.stop()
end

function OnPluginScreendraw(t, log, line)
if not tts_enabled then
return
end --tts off
-- checking for an empty string, or a string composed only of spaces.
-- If we don't, NVDA says blank.
if (t == 0 or t == 1) and not line:find("^%s*$") then
say(line)
end
end --function
function TTSToggle (name, line, wc)
if tts_enabled then
tts_enabled = false
stop()
say("speech off")
else
tts_enabled = true
stop()
say("speech on")
end
end
function OnPluginTabComplete(word)
if tts_enabled then
say(word)
end
end

]]>            
 </script> 
</muclient>
